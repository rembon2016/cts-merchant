<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chat CS â€” Finance App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { primary: '#002F6C' },
          boxShadow: { soft: '0 8px 28px rgba(2,22,47,.08)' }
        }
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    html,body{font-family:Inter,ui-sans-serif,system-ui;background:#f3f4f6}
    .safe-bottom{padding-bottom:calc(env(safe-area-inset-bottom)+96px)}
    .safe-top{padding-top:calc(env(safe-area-inset-top)+8px)}
    .bubble{max-width:76%}
  </style>
</head>
<body class="bg-gray-100">
  <main class="max-w-sm mx-auto min-h-screen safe-bottom safe-top relative">

    <!-- Topbar -->
    <header class="px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">

        <div class="w-12 h-12 rounded-xl bg-primary/10 grid place-items-center text-primary font-semibold">CS</div>
        <div>
          <p class="font-semibold">Customer Service</p>
          <p class="text-xs text-green-600">Online</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
          <!-- Voice button -->
          <button class="p-2 rounded-xl bg-white shadow-md hover:bg-slate-100 transition" aria-label="voice" title="Voice Message">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11 5a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V8a3 3 0 0 0-3-3z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 19v2m-4 0h8"/>
            </svg>
          </button>

          <!-- More button -->
          <button class="p-2 rounded-xl bg-white shadow-md hover:bg-slate-100 transition" aria-label="more" title="More Options">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v.01M12 12v.01M12 18v.01"/>
            </svg>
          </button>
        </div>
    </header>

    <!-- Chat area -->
    <section class="px-4 mt-2">
      <div id="chatWrap" class="bg-transparent h-[60vh] overflow-y-auto px-2 py-3 space-y-3" tabindex="0">
        <!-- messages rendered here -->
      </div>

      <!-- Quick replies -->
      <div class="mt-2 flex gap-2 px-2 overflow-x-auto pb-2">
        <button class="quick btn-qr bg-white rounded-full px-3 py-2 text-sm shadow-sm">Status Pesanan</button>
        <button class="quick btn-qr bg-white rounded-full px-3 py-2 text-sm shadow-sm">Minta Invoice</button>
        <button class="quick btn-qr bg-white rounded-full px-3 py-2 text-sm shadow-sm">Refund</button>
        <button class="quick btn-qr bg-white rounded-full px-3 py-2 text-sm shadow-sm">Hubungkan ke Agent</button>
      </div>

      <!-- Input area -->
      <div class="mt-3 bg-white rounded-2xl p-3 shadow-soft flex items-end gap-2">
        <input id="inputMsg" type="text" placeholder="Ketik pesan..." class="flex-1 rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none" />
        <input id="fileInput" type="file" class="hidden" />
        <button id="attachBtn" class="p-2 rounded-lg bg-slate-100">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-700" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M21.44 11.05 12 20.5a5 5 0 0 1-7.07 0 5 5 0 0 1 0-7.07l8.49-8.49a3.5 3.5 0 1 1 4.95 4.95l-8.49 8.49a1.5 1.5 0 0 1-2.12-2.12L16.3 8.3"/></svg>
        </button>
        <button id="emojiBtn" class="p-2 rounded-lg bg-slate-100">ðŸ˜Š</button>
        <button id="sendBtn" class="px-3 py-2 bg-primary text-white rounded-xl">Kirim</button>
      </div>
    </section>

    <div class="h-28"></div>

    <!-- Bottom nav -->
    <nav class="fixed bottom-0 inset-x-0">
      <div class="max-w-sm mx-auto">
        <div class="mx-4 mb-4 rounded-3xl bg-white shadow-soft border border-slate-100 px-2 py-2 grid grid-cols-5 gap-1">
          <a href="./index.html" class="group flex flex-col items-center gap-1 py-1">
            <span class="size-9 grid place-items-center rounded-2xl bg-primary/10 text-primary">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M3 10.5 12 4l9 6.5V20a1 1 0 0 1-1 1h-4v-6H8v6H4a1 1 0 0 1-1-1v-9.5Z"/></svg>
            </span>
            <span class="text-[11px] font-medium text-primary">Home</span>
          </a>
          <a href="./transaction.html" class="group flex flex-col items-center gap-1 py-1">
            <span class="size-9 grid place-items-center rounded-2xl bg-slate-100 text-slate-700">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M3 7h13m0 0-3-3m3 3-3 3M21 17H8m0 0 3-3m-3 3 3 3"/></svg>
            </span>
            <span class="text-[11px] text-slate-600">Transaksi</span>
          </a>
          <a href="#" class="group flex flex-col items-center gap-1 py-1">
            <span class="size-9 grid place-items-center rounded-2xl bg-slate-100 text-slate-700">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="size-5"><rect width="18" height="12" x="3" y="6" rx="2" ry="2" stroke-width="1.75"/><path d="M3 10h18" stroke-width="1.75"/></svg>
            </span>
            <span class="text-[11px] text-slate-600">POS</span>
          </a>
          <!--<a href="#" class="group flex flex-col items-center gap-1 py-1">-->
          <!--  <span class="size-9 grid place-items-center rounded-2xl bg-slate-100 text-slate-700">-->
          <!--    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M11 5 6 9H3v6h3l5 4V5Zm6.5 2.5a5 5 0 0 1 0 9M15 9a3 3 0 0 1 0 6"/></svg>-->
          <!--  </span>-->
          <!--  <span class="text-[11px] text-slate-600">Soundbox</span>-->
          <!--</a>-->
          <a href="./cs.html" class="group flex flex-col items-center gap-1 py-1">
            <span class="size-9 grid place-items-center rounded-2xl bg-slate-100 text-slate-700">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M3 11a9 9 0 1 1 18 0v6a3 3 0 0 1-3 3h-2v-6h5M6 20H5a2 2 0 0 1-2-2v-6h5v6H6Z"/></svg>
            </span>
            <span class="text-[11px] text-slate-600">CS</span>
          </a>
          <a href="./profile.html" class="group flex flex-col items-center gap-1 py-1">
            <span class="size-9 grid place-items-center rounded-2xl bg-slate-100 text-slate-700">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm7 8a7 7 0 0 0-14 0"/></svg>
            </span>
            <span class="text-[11px] text-slate-600">Profil</span>
          </a>
        </div>
      </div>
    </nav>

  </main>

  <script>
    // Sample conversation
    const sample = [
      {id:1, from:'cs', text:'Halo, ada yang bisa kami bantu hari ini?', time:'10:00'},
      {id:2, from:'user', text:'Hai, saya mau cek status transaksi TXN001', time:'10:01', status:'sent'},
      {id:3, from:'cs', text:'Tentu, mohon tunggu sebentar. Saya cek dulu ya.', time:'10:01'},
      {id:4, from:'cs', text:'Transaksi TXN001 berstatus SUCCESS pada 2025-08-15 10:30. Apakah ada yang ingin kami bantu lagi?', time:'10:02'}
    ];

    const chatWrap = document.getElementById('chatWrap');
    const inputMsg = document.getElementById('inputMsg');
    const sendBtn = document.getElementById('sendBtn');
    const fileInput = document.getElementById('fileInput');
    const attachBtn = document.getElementById('attachBtn');

    // Renders messages
    function render(){
      chatWrap.innerHTML = '';
      sample.forEach(m => {
        const el = document.createElement('div');
        el.className = m.from === 'user' ? 'flex justify-end px-2' : 'flex justify-start px-2';
        el.innerHTML = `
          <div class="bubble ${m.from==='user' ? 'bg-primary/10 text-primary rounded-2xl p-3' : 'bg-white rounded-2xl p-3 shadow'}">
            <div class="text-sm">${escapeHtml(m.text)}</div>
            <div class="text-[10px] mt-1 text-slate-400 text-right">${m.time} ${m.status ? 'â€¢ ' + m.status : ''}</div>
          </div>
        `;
        chatWrap.appendChild(el);
      });
      // scroll to bottom
      chatWrap.scrollTop = chatWrap.scrollHeight;
    }

    function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // send message
    function sendMessage(text, opts={}){
      if(!text) return;
      const t = new Date();
      const hh = String(t.getHours()).padStart(2,'0');
      const mm = String(t.getMinutes()).padStart(2,'0');
      const msg = { id: Date.now(), from:'user', text, time:`${hh}:${mm}`, status:'sent', ...opts };
      sample.push(msg);
      render();
      inputMsg.value = '';
      // simulate CS typing + reply
      simulateCsReply(text);
    }

    // Quick replies
    document.querySelectorAll('.quick').forEach(b => b.addEventListener('click', (e) => {
      const txt = e.target.textContent.trim();
      sendMessage(txt);
    }));

    sendBtn.addEventListener('click', ()=> sendMessage(inputMsg.value.trim()));
    inputMsg.addEventListener('keydown', (e)=> { if(e.key === 'Enter'){ e.preventDefault(); sendMessage(inputMsg.value.trim()); } });

    attachBtn.addEventListener('click', ()=> fileInput.click());
    fileInput.addEventListener('change', (e)=>{
      const file = e.target.files[0];
      if(!file) return;
      sendMessage(`Mengirim file: ${file.name}`);
      fileInput.value = null;
    });

    // simulated CS reply (simple rules)
    let typingTimer = null;
    function simulateCsReply(userText){
      // show typing indicator
      const typingEl = document.createElement('div');
      typingEl.className = 'flex justify-start px-2';
      typingEl.innerHTML = `
        <div class="bg-white rounded-2xl p-3 shadow bubble">
          <div class="text-sm text-slate-500">typing<span class="animate-pulse">...</span></div>
        </div>
      `;
      chatWrap.appendChild(typingEl);
      chatWrap.scrollTop = chatWrap.scrollHeight;

      clearTimeout(typingTimer);
      typingTimer = setTimeout(() => {
        // remove typing
        typingEl.remove();
        // build a reply based on keywords
        let reply = 'Terima kasih, sudah diinformasikan. Tim kami akan menindaklanjuti.';
        const t = userText.toLowerCase();
        if(t.includes('status')) reply = 'Saya cek statusnya: TXN001 sudah SUCCESS pada 2025-08-15 10:30.';
        if(t.includes('refund')) reply = 'Mohon maaf, untuk refund kami membutuhkan nomor rekening dan alasan. Mau lanjut?' ;
        if(t.includes('invoice') || t.includes('invoice') ) reply = 'Baik, kami sudah mengirim invoice ke email terdaftar.';

        const now = new Date();
        const hh = String(now.getHours()).padStart(2,'0');
        const mm = String(now.getMinutes()).padStart(2,'0');
        sample.push({ id: Date.now()+1, from:'cs', text: reply, time: `${hh}:${mm}` });
        render();
      }, 900);
    }

    // init
    render();

  </script>
</body>
</html>
